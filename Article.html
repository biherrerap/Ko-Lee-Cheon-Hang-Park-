[[Archivo:Adi Shamir 2009 crop.jpg|thumb|right|230px|[[Adi Shamir]], desarrollador del sistema de compartición de secretos que lleva su nombre.]]
El '''sistema de compartición de secretos de Shamir''' es un [[algoritmo]] [[criptografía|criptográfico]]. Es una forma de compartición de secretos donde un secreto se divide en partes y se da a cada participante una sola: todas o parte de ellas son necesarias para reconstruir el secreto.

El algoritmo basa su funcionamiento en una propiedad de los [[polinomio]]s interpoladores<ref>[http://www.x5.net/faqs/crypto/q104.html What is Shamir's Secret Sharing Scheme?] en X5 Networks</ref> y fue desarrollado por el criptógrafo [[israel]]í [[Adi Shamir]], que lo presentó en [[1979]].<ref name="paz"/>

== Definición matemática ==
<!-- Using <math>...\,\!</math> to force consistent LaTeX markup -->
Formalmente, nuestro objetivo es dividir un conjunto de datos <math>D\,\!</math> (por ejemplo, una clave) en <math>n\,\!</math> partes <math>D_1,\cdots,D_n\,\!</math> de manera que:<br />
# El conocimiento de <math>k\,\!</math> o más <math>D_i\,\!</math> partes hace que <math>D\,\!</math> sea fácilmente computable.<ref>{{cita libro | autor = Carracedo Gallardo, Justo | capítulo = Servicios de anonimato para la Sociedad de la Información | título = Seguridad en redes telemáticas | año = 2004 | editorial = Editorial McGraw-Hill | id = ISBN 84-481-4157-1}}, p. 470</ref>
# El conocimiento de <math>k-1\,\!</math> o menos <math>D_i\,\!</math> partes hace que <math>D\,\!</math> esté indeterminado, en el sentido de que todos sus valores posibles tienen la misma probabilidad de ser verdaderos.

Esta combinación se denomina combinación o esquema de [[umbral]] <math>\left(k,n\right)\,\!</math>.<ref name="paz">{{cita publicación | autor = Morillo, Paz | título = Las matemáticas en la criptología | año = mayo-agosto de [[2006]] | publicación = Encuentros multidisciplinares. Universidad Politécnica de Catalunya | número = 23 | url = http://www.encuentros-multidisciplinares.org/Revistan%C2%BA23/Paz%20Morillo%20Bosch.pdf}}</ref> 
Si <math>k=n\,\!</math> se requiere la concurrencia de todos los participantes para reconstruir el secreto.

== Sistema de compartición de secretos de Shamir ==
[[File:3 polynomials of degree 2 through 2 points.svg|thumb|right|Se pueden dibujar infinitos polinomios de grado 2 que pasen por 2 puntos. Se necesitan 3 puntos para definir un polinomio único de grado 2. Esta imagen sólo tiene fines ilustrativos - El esquema de Shamir utiliza polinómios en un [[conjunto finito]], no representable en un plano bidimensional.]]
La idea esencial de la combinación de umbral de Shamir es que dos [[Punto (geometría)|puntos]] son suficientes para definir una [[línea recta]], tres puntos lo son para definir una [[parábola (matemática)|parábola]], cuatro para definir una [[Ecuación de tercer grado|curva cúbica]] y así sucesivamente. Es decir, son necesarios <math>n+1\,\!</math> puntos para definir un [[polinomio]] de grado <math>n\,\!</math>.

Supongamos que queremos trabajar con un umbral de <math>\left(k,n\right)\,\!</math> para compartir un secreto <math>S\,\!</math> (cualquier número, [[sin pérdida de generalidad]]) siendo <math>k<n\,\!</math>. La elección de los valores de <math>k\,\!</math> y <math>n\,\!</math> determina la fortaleza del sistema.

Eligiendo al azar <math>\left(k-1\right)\,\!</math> coeficientes <math>a_1,\cdots,a_{k-1}\,\!</math>, y siendo <math>a_0=S\,\!</math>, se construye el polinomio <math>f\left(x\right)=a_0+a_1x+a_2x^2+a_3x^3+\cdots+a_{k-1}x^{k-1}\,\!</math>. Calculamos cualesquiera <math>n\,\!</math> puntos a partir del mismo, por ejemplo determinamos que <math>i=1,\cdots,n\,\!</math> de lo que se deriva <math>\left(i,f\left(i\right)\right)\,\!</math>. A todo participante en el secreto se le da un punto (un par de valores, el de entrada y el de salida para el polinomio)

Dado cualquier subconjunto de <math>k\,\!</math> entre estos pares, podemos calcular los coeficientes del polinomio mediante interpolación y luego despejar <math>a_0\,\!</math>, que es el secreto.

== Ejemplo de uso ==
=== Preparación ===
Supongamos que el secreto es el número de una tarjeta de crédito: 1234 <math>(S=1234)\,\!</math>.

Queremos dividir el secreto en seis partes <math>(n=6)\,\!</math>, de forma que cualquier subconjunto  <math>(k=3)\,\!</math> sea suficiente para reconstruir el secreto. Al azar obtenemos <math>k-1</math> números: por ejemplo, 166 y 94.

<math>(a_1=166;a_2=94)\,\!</math>

El polinomio con el que operaremos será por lo tanto:

<math>f\left(x\right)=1234+166x+94x^2\,\!</math>

Calculamos seis puntos a partir del polinomio:

<math>\left(1,1494\right);\left(2,1942\right);\left(3,2578\right);\left(4,3402\right);\left(5,4414\right);\left(6,5614\right)\,\!</math>

Damos a cada partícipe un único punto, que comprende el valor <math>x\,\!</math> y <math>f\left(x\right)\,\!</math>).

=== Reconstrucción ===
Para reconstruir el secreto bastará con tres puntos.

Considérese

<math>\left(x_0,y_0\right)=\left(2,1942\right);\left(x_1,y_1\right)=\left(4,3402\right);\left(x_2,y_2\right)=\left(5,4414\right)\,\!</math>.

Usamos la [[interpolación polinómica de Lagrange]]:

<math>\ell_0=\frac{x-x_1}{x_0-x_1}\cdot\frac{x-x_2}{x_0-x_2}=\frac{x-4}{2-4}\cdot\frac{x-5}{2-5}=\frac{1}{6}x^2-\frac{3}{2}x+\frac{10}{3}\,\!</math>

<math>\ell_1=\frac{x-x_0}{x_1-x_0}\cdot\frac{x-x_2}{x_1-x_2}=\frac{x-2}{4-2}\cdot\frac{x-5}{4-5}=-\frac{1}{2}x^2+\frac{7}{2}x-5\,\!</math>

<math>\ell_2=\frac{x-x_0}{x_2-x_0}\cdot\frac{x-x_1}{x_2-x_1}=\frac{x-2}{5-2}\cdot\frac{x-4}{5-4}=\frac{1}{3}x^2-2x+\frac{8}{3}\,\!</math>

Por lo tanto,

<math>f(x)=\sum_{j=0}^2 y_j\cdot\ell_j(x)\,\!</math>

<math>=1942\cdot\left(\frac{1}{6}x^2-\frac{3}{2}x+\frac{10}{3}\right)+3402\cdot\left(-\frac{1}{2}x^2+\frac{7}{2}x-5\right)+4414\cdot\left(\frac{1}{3}x^2-2x+\frac{8}{3}\right)\,\!</math>

<math>=1234+166x+94x^2\,\!</math>
<br /><br />
Teniendo en cuenta que el secreto es el coeficiente de <math>x^0\,\!</math>, el secreto original es <math>S=1234\,\!</math>.

== Referencias ==
{{listaref}}
* {{cita publicación
| autor = Shamir, Adi
| título = How to share a secret
| año = noviembre de 1979
| publicación = Communications of the ACM
| volumen = 22
| número = 11
| id = ISSN 0001-0782
| url = http://histo.cat/1/How-to-share-a-secret.pdf
}}, pp. 612-613

[[Categoría:Algoritmos criptográficos]]
[[Categoría:Epónimos relacionados con las matemáticas]]
